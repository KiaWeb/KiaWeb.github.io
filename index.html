<!DOCTYPE html>
<html lang="en" data-theme="aero-light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light" />
  <title>Kia's Video Player</title>

  <style>
    /* Reset & base */
    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body { margin: 0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif; color: #0b2942; }

    /* ——————— AERO THEME ——————— */
    :root {
      /* Desktop wallpaper vibes */
      --wallpaper-1: #0a2a53;  /* deep sapphire */
      --wallpaper-2: #104a82;  /* azure */
      --wallpaper-3: #0b7ab3;  /* sky */
      --wallpaper-4: #7bc4ff;  /* highlight */

      /* Glass tokens */
      --glass-bg: rgba(255, 255, 255, 0.35);
      --glass-stroke: rgba(255, 255, 255, 0.55);
      --glass-stroke-outer: rgba(0, 0, 0, 0.25);
      --glass-shadow: 0 20px 60px rgba(0, 0, 0, 0.35);
      --glass-blur: 18px;

      /* Accent & text */
      --accent: #3ea6ff; /* Windows 7-ish glow blue */
      --text: rgba(10, 25, 40, 0.92);
      --muted: rgba(10, 25, 40, 0.65);
    }

    /* Animated wallpaper reminiscent of Windows 7 aurora */
    body {
      color: var(--text);
      background:
        radial-gradient(1200px 700px at 10% -10%, rgba(123,196,255,0.22), transparent 55%),
        radial-gradient(900px 600px at 110% 10%, rgba(62,166,255,0.18), transparent 55%),
        linear-gradient(130deg, var(--wallpaper-1), var(--wallpaper-2) 35%, var(--wallpaper-3) 70%, var(--wallpaper-2));
      background-size: 220% 220%;
      animation: wallpaperShift 24s ease-in-out infinite;
      overflow: hidden;
    }
    @keyframes wallpaperShift { 0%{background-position:0% 40%} 50%{background-position:100% 60%} 100%{background-position:0% 40%} }

    /* Soft light streaks */
    .streaks::before, .streaks::after {
      content: ""; position: fixed; inset: -20%; pointer-events: none; mix-blend-mode: screen; opacity: .5;
      background: radial-gradient(50% 80% at 30% 10%, rgba(255,255,255,.18), transparent 60%),
                  radial-gradient(40% 60% at 80% 20%, rgba(255,255,255,.12), transparent 60%),
                  radial-gradient(40% 60% at 60% 90%, rgba(123,196,255,.12), transparent 65%);
      filter: blur(30px) saturate(120%);
      animation: streakDrift 30s ease-in-out infinite alternate;
    }
    .streaks::after { animation-duration: 38s; opacity: .35; }
    @keyframes streakDrift { from{transform: translate3d(-10px,0,0)} to{transform: translate3d(10px,0,0)} }

    /* Desktop-like layout */
    .shell { display: grid; grid-template-rows: auto 1fr; gap: 18px; padding: clamp(14px, 2.6vw, 32px); min-height: 100%; }

    /* Glass window frame (title bar + content) */
    .window {
      position: relative;
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,.55), rgba(255,255,255,.28));
      background-clip: padding-box;
      border: 1px solid var(--glass-stroke-outer);
      box-shadow: var(--glass-shadow);
      overflow: hidden;
      backdrop-filter: blur(var(--glass-blur)) saturate(120%);
      -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(120%);
    }

    /* Subtle inner highlight (Aero edge) */
    .window::before { content:""; position:absolute; inset:0; border-radius: inherit; pointer-events:none;
      box-shadow: inset 0 1px 0 var(--glass-stroke), inset 0 0 0 1px rgba(255,255,255,.12);
    }

    /* Title bar */
    .titlebar { display:flex; align-items:center; gap:10px; padding:10px 12px; background: linear-gradient(180deg, rgba(255,255,255,.45), rgba(255,255,255,.25)); border-bottom: 1px solid rgba(255,255,255,.5); }
    .titlebar .controls { display:flex; gap:8px; margin-right: 8px; }
    .dot { width:12px; height:12px; border-radius:50%; box-shadow: inset 0 1px 0 rgba(255,255,255,.7), 0 0 0 1px rgba(0,0,0,.25); }
    .dot.min { background: radial-gradient(circle at 30% 30%, #fff, #b8e6ff 60%, #6fc2ff); }
    .dot.max { background: radial-gradient(circle at 30% 30%, #fff, #b7ffd8 60%, #52e3a1); }
    .dot.close { background: radial-gradient(circle at 30% 30%, #fff, #ffc6c6 60%, #ff7b7b); }

    .titlebar h1 { margin: 0; font-weight: 700; font-size: 0.95rem; color: var(--text); letter-spacing: .2px; text-shadow: 0 1px 0 rgba(255,255,255,.6); overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
    .titlebar .right { margin-left: auto; display:flex; align-items:center; gap:10px; }

    .glass-chip { padding: 6px 10px; border-radius: 999px; font-size: .8rem; color: var(--muted); background: rgba(255,255,255,.5); border: 1px solid rgba(255,255,255,.7); box-shadow: inset 0 1px 0 rgba(255,255,255,.7); backdrop-filter: blur(8px); }

    /* Content area */
    .content { padding: 14px; }

    /* Title pill under the window (mirrors Aero notifications) */
    #videoTitle { margin: 6px 2px 6px; align-self: start; padding: 8px 12px; font-weight: 700; border-radius: 12px; background: rgba(255,255,255,.55); border: 1px solid rgba(255,255,255,.7); display:inline-block; backdrop-filter: blur(8px); text-shadow: 0 1px 0 rgba(255,255,255,.65); box-shadow: 0 10px 28px rgba(0,0,0,.15); }
    #videoTitle.error { color:#8b1028; border-color: rgba(255,255,255,.9); background: rgba(255,240,244,.75); }

    /* Player container */
    .player-container { width: 100%; max-width: 1200px; margin: 0 auto; }

    /* Aero glass panel holding the player */
    .aero-panel { position: relative; border-radius: 14px; padding: 10px; background: rgba(255,255,255,.28); border: 1px solid rgba(255,255,255,.6); backdrop-filter: blur(16px) saturate(125%); -webkit-backdrop-filter: blur(16px) saturate(125%); box-shadow: 0 12px 36px rgba(0,0,0,.25); }

    /* The chrome around the SWF player */
    .flash-player { position: relative; width: 100%; aspect-ratio: 16/9; border-radius: 12px; overflow: hidden; background: rgba(15, 30, 50, .25); border: 1px solid rgba(255,255,255,.6); box-shadow:
        inset 0 1px 0 rgba(255,255,255,.7), /* top edge highlight */
        inset 0 -1px 0 rgba(0,0,0,.15),    /* bottom inner shadow */
        0 8px 26px rgba(0,0,0,.28);
    }

    /* Gloss highlight */
    .flash-player::after { content:""; position:absolute; inset:0; pointer-events:none; background:
        linear-gradient(180deg, rgba(255,255,255,.35), rgba(255,255,255,0) 35%),
        linear-gradient(0deg, rgba(255,255,255,.05), rgba(255,255,255,0) 70%);
    }

    /* Subtle animated glow ring (Aero bloom) */
    .aero-panel::before { content:""; position:absolute; inset:-10px; border-radius: 18px; filter: blur(16px); pointer-events:none; background: conic-gradient(from 0deg, rgba(62,166,255,.0) 0deg, rgba(62,166,255,.35) 120deg, rgba(255,255,255,.0) 300deg); animation: spin 14s linear infinite; opacity: .7; }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Controls button (theme tint switcher) */
    .tint-toggle { appearance: none; border: 1px solid rgba(255,255,255,.7); background: rgba(255,255,255,.55); border-radius: 999px; padding: 8px 12px; font-weight: 600; cursor: pointer; box-shadow: inset 0 1px 0 rgba(255,255,255,.9), 0 8px 20px rgba(0,0,0,.12); }
    .tint-toggle:active { transform: translateY(1px); }
	a.tint-toggle {
	  text-decoration: none;
	  color: var(--text);
	  font-weight: 600;
	  background: rgba(255,255,255,.55);
	  border: 1px solid rgba(255,255,255,.7);
	  border-radius: 999px;
	  padding: 8px 12px;
	  box-shadow: inset 0 1px 0 rgba(255,255,255,.9), 0 8px 20px rgba(0,0,0,.12);
	  display: inline-block;
	}



    /* Aspect on small screens */
    @media (max-width: 768px) {
      .titlebar h1 { max-width: 45vw; }
      .flash-player { aspect-ratio: 16/9; }
    }
  </style>

  <script src="https://unpkg.com/@ruffle-rs/ruffle"></script>
</head>
<body>
  <div class="streaks"></div>
  <div class="shell">
    <!-- Glass window shell -->
    <section class="window" aria-label="Kia Aero Player Window">
      <header class="titlebar">
        <div class="controls" aria-hidden="true">
          <div class="dot close"></div>
          <div class="dot min"></div>
          <div class="dot max"></div>
        </div>
        <h1>Kia's Video Player</h1>
        <div class="right">
		  <button id="tintToggle" class="tint-toggle" title="Switch glass tint">Switch tint</button>
		  <a href="archive" class="tint-toggle" title="Go to archive">Archive</a>
		</div>

      </header>
      <div class="content">
        <p id="videoTitle">Loading video...</p>
        <div class="player-container" id="playerContainer">
          <div class="aero-panel" id="aeroPanel"></div>
        </div>
      </div>
    </section>
  </div>

  <script>
    // ——— Tint switcher (subtle hue variations like Aero tints) ———
    (function(){
      const tints = [
        { w1:'#0a2a53', w2:'#104a82', w3:'#0b7ab3' },            // Blue
        { w1:'#092b2b', w2:'#0f4d4d', w3:'#0ba39a' },            // Teal
        { w1:'#2b0a3b', w2:'#4d0f82', w3:'#a30bb0' },            // Purple
        { w1:'#2b160a', w2:'#824a0f', w3:'#b36b0b' }             // Amber
      ];
      let i = 0;
      const apply = (t)=>{
        const root = document.documentElement;
        root.style.setProperty('--wallpaper-1', t.w1);
        root.style.setProperty('--wallpaper-2', t.w2);
        root.style.setProperty('--wallpaper-3', t.w3);
      };
      document.getElementById('tintToggle').addEventListener('click', ()=>{
        i = (i+1) % tints.length; apply(tints[i]);
      });
    })();

    // ——— Player Setup (using <video> instead of Flash/Ruffle) ———
    fetch("https://lightspeed.kiascdn.org/videos/videos.xml")
      .then(r => r.text())
      .then(xmlText => {
        const doc = new DOMParser().parseFromString(xmlText, "text/xml");
        const list = doc.getElementsByTagName("video");
        const title = document.getElementById("videoTitle");
        if (!list.length) { title.textContent = "No videos found."; title.classList.add("error"); return; }

        const v = list[Math.floor(Math.random() * list.length)];
        const name = v.getElementsByTagName("name")[0].textContent;
        const link = v.getElementsByTagName("link")[0].textContent;
        title.textContent = "Now playing: " + name;

        const mount = document.getElementById('aeroPanel');

        // OLD Flash / Ruffle code commented out:
        /*
        const hasFlash = ((typeof navigator.plugins !== "undefined" && typeof navigator.plugins["Shockwave Flash"] === "object")
          || (window.ActiveXObject && (new ActiveXObject("ShockwaveFlash.ShockwaveFlash")) !== false));

        if (hasFlash) {
          const obj = document.createElement("object");
          obj.setAttribute("data", "NewVideoPlayer.swf");
          obj.setAttribute("type", "application/x-shockwave-flash");
          obj.style.width = "100%"; obj.style.height = "100%"; obj.className = "flash-player";
          obj.innerHTML = `
            <param name="movie" value="NewVideoPlayer.swf" />
            <param name="allowFullScreen" value="true" />
            <param name="allowScriptAccess" value="always" />
            <param name="wmode" value="direct" />
            <param name="FlashVars" value="videoPath=${encodeURIComponent(link)}" />
          `;
          mount.appendChild(obj);
        } else {
          const ruffle = window.RufflePlayer.newest();
          const player = ruffle.createPlayer();
          player.classList.add("flash-player");
          mount.appendChild(player);
          player.load({ url: "NewVideoPlayer.swf", parameters: { videoPath: link } });
        }
        */

        // NEW: Simple HTML5 video element
        const vid = document.createElement("video");
        vid.className = "flash-player";
        vid.src = link;
        vid.controls = true;
        vid.playsInline = true;
        vid.preload = "metadata";
        vid.style.width = "100%";
        vid.style.height = "100%";
        mount.appendChild(vid);
      })
      .catch(err => {
        const t = document.getElementById("videoTitle");
        t.textContent = "Error loading video list."; t.classList.add("error");
        console.error("XML Load Error:", err);
      });
</script>

</body>
</html>